 function []= func(ndim,u,icp,par,ijac,f,dfdu,dfdp)
%               
;
   integer, intent(in) :: ndim, ijac, icp(*);
   foruble precision, intent(in) :: u(ndim), par(*);
   foruble precision, intent(out) :: f(ndim), dfdu(ndim,*), dfdp(ndim,*);
;
   foruble precision t1,t2,t3,t4,t5,t7,t8,t9,t10,t12,t13,t15,t16,t17,t19;
   foruble precision t22,t27,t28,t29,t33,t34,t36,t39;
   foruble precision t42,t43,t44,t50,t51,t54,t56,t58,t64,t65,t66,t68,t69;
   foruble precision t74,t86;
;
   t1 = par(2);
   t2 = u(1);
   t3 = exp(t2);
   t4 = t1*t3;
   t5 = t3**2;
   t7 = par(1);
   t8 = u(2);
   t9 = exp(t8);
   t10 = t7*t9;
   t12 = 1.d0+t4;
   t13 = 1.d0/t12;
   f(1) = -(-1.d0-t4+t3+t1*t5+t10)*t13;
   t15 = t7*t3;
   t16 = par(5);
   t17 = t16*t9;
   t19 = par(3);
   t22 = t19*t1;
   t27 = par(4);
   t28 = u(3);
   t29 = t27*t28;
   t33 = 1.d0+t17;
   t34 = 1.d0/t33;
   f(2) = (t15+t15*t17-t19-t19*t16*t9-t22*t3-t22*t3*t16*t9-t29-t29*t4)*t13*t34;
   t36 = par(6);
   t39 = t27*t9-t36-t36*t16*t9;
   f(3) = t28*t39*t34;
;
   if(ijac.eq.0)return;
;
   t42 = t1**2;
   t43 = 2.d0*t2;
   t44 = exp(t43);
   t50 = t12**2;
   t51 = 1.d0/t50;
   dfdu(1,1) = t3*(-1.d0-2.d0*t4-t42*t44+t1*t7*t9)*t51;
   dfdu(1,2) = -t10*t13;
   dfdu(1,3) = 0.d0;
   t54 = exp(t2+t8);
   t56 = t3+t16*t54;
   t58 = t51*t34;
   dfdu(2,1) = t7*t56*t58;
   t64 = t33**2;
   t65 = 1.d0/t64;
   t66 = (t9+t1*t54)*t13*t65;
   dfdu(2,2) = t16*t27*t28*t66;
   dfdu(2,3) = -t27*t34;
   dfdu(3,1) = 0.d0;
   t68 = t28*t9;
   t69 = t27*t65;
   dfdu(3,2) = t68*t69;
   dfdu(3,3) = t39*t34;
;
   if(ijac.eq.1)return;
;
   dfdp(1,1) = -t9*t13;
   dfdp(1,2) = t54*t7*t51;
   dfdp(1,3) = 0.d0;
   dfdp(1,4) = 0.d0;
   dfdp(1,5) = 0.d0;
   dfdp(1,6) = 0.d0;
   dfdp(2,1) = t56*t13*t34;
   t74 = exp(t43+t8);
   dfdp(2,2) = -t7*(t44+t74*t16)*t58;
   dfdp(2,3) = -(1.d0+t17+t4+t1*t16*t54)*t13*t34;
   dfdp(2,4) = -t28*t34;
   dfdp(2,5) = t29*t66;
   dfdp(2,6) = 0.d0;
   dfdp(3,1) = 0.d0;
   dfdp(3,2) = 0.d0;
   dfdp(3,3) = 0.d0;
   dfdp(3,4) = t68*t34;
   t86 = exp(2.d0*t8);
   dfdp(3,5) = -t28*t86*t69;
   dfdp(3,6) = -t28;

